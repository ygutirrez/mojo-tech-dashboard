<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoJo Marketing Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #1a5c1a 0%, #2d8f2d 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 { font-size: 24px; }
        .header .updated { font-size: 12px; opacity: 0.8; }
        .controls { display: flex; gap: 10px; align-items: center; }
        .controls select, .controls button {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            cursor: pointer;
        }
        .controls button { background: rgba(255,255,255,0.2); color: white; }
        .controls button:hover { background: rgba(255,255,255,0.3); }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .metric-card .label { 
            font-size: 11px; 
            color: #666; 
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .metric-card .value { 
            font-size: 26px; 
            font-weight: 700; 
            color: #1a1a1a;
            margin: 5px 0;
        }
        .metric-card.highlight { border-left: 4px solid #1a5c1a; }
        .platform-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .platform-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .platform-header h2 { font-size: 18px; font-weight: 600; }
        .platform-header .total { margin-left: auto; font-size: 14px; color: #666; }
        .platform-header .total strong { color: #1a5c1a; font-size: 18px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #f0f0f0; }
        th { font-size: 11px; text-transform: uppercase; color: #666; font-weight: 600; }
        td { font-size: 14px; }
        .status { 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 11px; 
            font-weight: 600;
        }
        .status.active, .status.enabled { background: #dcfce7; color: #166534; }
        .status.paused { background: #fef3c7; color: #92400e; }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .chart-card h3 { font-size: 16px; margin-bottom: 15px; color: #333; }
        .no-data { text-align: center; padding: 40px; color: #999; }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <h1>ü¶ü MoJo Marketing Dashboard</h1>
            <div class="updated">Last updated: <span id="lastUpdated">Loading...</span></div>
        </div>
        <div class="controls">
            <select id="dateRange" onchange="updateDashboard()">
                <option value="7">Last 7 Days</option>
                <option value="14">Last 14 Days</option>
                <option value="30" selected>Last 30 Days</option>
                <option value="90">Last 90 Days</option>
                <option value="all">All Time</option>
            </select>
            <button onclick="location.reload()">‚Üª Refresh</button>
        </div>
    </div>

    <div class="metrics-grid">
        <div class="metric-card highlight">
            <div class="label">Total Spend</div>
            <div class="value" id="totalSpend">$0</div>
        </div>
        <div class="metric-card">
            <div class="label">Total Clicks</div>
            <div class="value" id="totalClicks">0</div>
        </div>
        <div class="metric-card">
            <div class="label">Avg CPC</div>
            <div class="value" id="avgCPC">$0</div>
        </div>
        <div class="metric-card">
            <div class="label">Impressions</div>
            <div class="value" id="totalImpressions">0</div>
        </div>
        <div class="metric-card">
            <div class="label">Conversions</div>
            <div class="value" id="totalConversions">0</div>
        </div>
        <div class="metric-card highlight">
            <div class="label">Cost/Conversion</div>
            <div class="value" id="costPerConv">$0</div>
        </div>
    </div>

    <div class="charts-grid">
        <div class="chart-card">
            <h3>üí∞ Spend by Platform</h3>
            <canvas id="spendChart"></canvas>
        </div>
        <div class="chart-card">
            <h3>üëÜ Clicks by Platform</h3>
            <canvas id="clicksChart"></canvas>
        </div>
    </div>

    <div class="platform-section">
        <div class="platform-header">
            <span style="font-size: 24px;">üìò</span>
            <h2>Meta Ads (Facebook/Instagram)</h2>
            <div class="total">Total: <strong id="metaTotal">$0</strong></div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Campaign</th>
                    <th>Status</th>
                    <th>Spend</th>
                    <th>Impressions</th>
                    <th>Clicks</th>
                    <th>CPC</th>
                    <th>CTR</th>
                </tr>
            </thead>
            <tbody id="metaBody">
                <tr><td colspan="7" class="no-data">Loading...</td></tr>
            </tbody>
        </table>
    </div>

    <div class="platform-section">
        <div class="platform-header">
            <span style="font-size: 24px;">üîç</span>
            <h2>Google Ads</h2>
            <div class="total">Total: <strong id="googleTotal">$0</strong></div>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Campaign</th>
                    <th>Status</th>
                    <th>Spend</th>
                    <th>Impressions</th>
                    <th>Clicks</th>
                    <th>Conversions</th>
                </tr>
            </thead>
            <tbody id="googleBody">
                <tr><td colspan="6" class="no-data">Loading...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        // Dashboard data by date range
        const dashboardData = {
            lastUpdated: new Date().toLocaleString(),
            ranges: {
                "7": {
                    meta: {
                        campaigns: [
                            { name: "Cyber Monday 2025 - IG Video", status: "ACTIVE", spend: 112.50, impressions: 3800, clicks: 68, cpc: 1.65, ctr: "1.79%" }
                        ],
                        totalSpend: 112.50
                    },
                    google: {
                        campaigns: [
                            { name: "Misting system F", status: "enabled", spend: 98.50, impressions: 12500, clicks: 890, conversions: 45 },
                            { name: "PMax: Local Ad", status: "enabled", spend: 45.20, impressions: 8200, clicks: 120, conversions: 2 },
                            { name: "LeadGen-Search", status: "enabled", spend: 125.30, impressions: 450, clicks: 38, conversions: 8 }
                        ],
                        totalSpend: 269.00
                    }
                },
                "14": {
                    meta: {
                        campaigns: [
                            { name: "Cyber Monday 2025 - IG Video", status: "ACTIVE", spend: 225.00, impressions: 7600, clicks: 136, cpc: 1.65, ctr: "1.79%" }
                        ],
                        totalSpend: 225.00
                    },
                    google: {
                        campaigns: [
                            { name: "Misting system F", status: "enabled", spend: 197.00, impressions: 25000, clicks: 1780, conversions: 90 },
                            { name: "PMax: Local Ad", status: "enabled", spend: 90.40, impressions: 16400, clicks: 240, conversions: 4 },
                            { name: "LeadGen-Search", status: "enabled", spend: 250.60, impressions: 900, clicks: 76, conversions: 16 }
                        ],
                        totalSpend: 538.00
                    }
                },
                "30": {
                    meta: {
                        campaigns: [
                            { name: "Cyber Monday 2025 - IG Video", status: "ACTIVE", spend: 459.70, impressions: 15549, clicks: 277, cpc: 1.66, ctr: "1.78%" }
                        ],
                        totalSpend: 459.70
                    },
                    google: {
                        campaigns: [
                            { name: "Mosquito Control Services", status: "enabled", spend: 630.79, impressions: 3055, clicks: 171, conversions: 29 },
                            { name: "$40 On Us for Mosquito Control", status: "enabled", spend: 486.11, impressions: 33490, clicks: 644, conversions: 30 }
                        ],
                        totalSpend: 1116.90
                    }
                },
                "90": {
                    meta: {
                        campaigns: [
                            { name: "Cyber Monday 2025 - IG Video", status: "ACTIVE", spend: 459.70, impressions: 15549, clicks: 277, cpc: 1.66, ctr: "1.78%" },
                            { name: "Misting System Home Value", status: "ACTIVE", spend: 850.20, impressions: 42000, clicks: 680, cpc: 1.25, ctr: "1.62%" },
                            { name: "MoJo on CBS News", status: "ACTIVE", spend: 320.50, impressions: 28000, clicks: 195, cpc: 1.64, ctr: "0.70%" }
                        ],
                        totalSpend: 1630.40
                    },
                    google: {
                        campaigns: [
                            { name: "Misting system Funnel-PMax", status: "enabled", spend: 1840.02, impressions: 2010601, clicks: 19052, conversions: 18384 },
                            { name: "Mosquito Control Services", status: "enabled", spend: 25367.83, impressions: 259741, clicks: 13385, conversions: 1857 },
                            { name: "$40 On Us Promo", status: "enabled", spend: 6839.56, impressions: 315903, clicks: 11363, conversions: 202 },
                            { name: "PMax: Local Ad", status: "enabled", spend: 437.69, impressions: 506277, clicks: 709, conversions: 3 },
                            { name: "LeadGen-Search", status: "enabled", spend: 1751.03, impressions: 1897, clicks: 187, conversions: 28 },
                            { name: "Lead Gen-Performance Max", status: "enabled", spend: 1265.49, impressions: 184107, clicks: 1725, conversions: 8 },
                            { name: "Vince Youtube", status: "enabled", spend: 819.44, impressions: 56012, clicks: 3281, conversions: 0 },
                            { name: "YouTube Video Views", status: "enabled", spend: 150.05, impressions: 32206, clicks: 167, conversions: 0 }
                        ],
                        totalSpend: 38471.11
                    }
                },
                "all": {
                    meta: {
                        campaigns: [
                            { name: "Cyber Monday 2025 - IG Video", status: "ACTIVE", spend: 459.70, impressions: 15549, clicks: 277, cpc: 1.66, ctr: "1.78%" },
                            { name: "Misting System Home Value", status: "ACTIVE", spend: 850.20, impressions: 42000, clicks: 680, cpc: 1.25, ctr: "1.62%" },
                            { name: "MoJo on CBS News", status: "ACTIVE", spend: 320.50, impressions: 28000, clicks: 195, cpc: 1.64, ctr: "0.70%" }
                        ],
                        totalSpend: 1630.40
                    },
                    google: {
                        campaigns: [
                            { name: "Mosquito Control Services", status: "enabled", spend: 25367.83, impressions: 259741, clicks: 13385, conversions: 1857 },
                            { name: "New Lead Gen Feb2024", status: "paused", spend: 20901.38, impressions: 55955, clicks: 3860, conversions: 407 },
                            { name: "Misting system Funnel-PMax", status: "enabled", spend: 1840.02, impressions: 2010601, clicks: 19052, conversions: 18384 },
                            { name: "Lead Gen Video 2021", status: "removed", spend: 7821.73, impressions: 569459, clicks: 4270, conversions: 0 },
                            { name: "$40 On Us Promo", status: "enabled", spend: 6839.56, impressions: 315903, clicks: 11363, conversions: 202 },
                            { name: "Leads-Gmail-ad-1", status: "removed", spend: 4280.85, impressions: 45679, clicks: 4395, conversions: 0 },
                            { name: "Dynamic Ad - Website Traffic", status: "paused", spend: 4347.27, impressions: 6884, clicks: 832, conversions: 118 },
                            { name: "Misting System - Awareness", status: "paused", spend: 4064.51, impressions: 25447, clicks: 780, conversions: 44 },
                            { name: "Website traffic-Search", status: "paused", spend: 4016.61, impressions: 62236, clicks: 1105, conversions: 27 },
                            { name: "Performance Max 11-15-2024", status: "paused", spend: 3729.94, impressions: 193856, clicks: 2884, conversions: 85 },
                            { name: "Website traffic-Display", status: "paused", spend: 2217.98, impressions: 1184283, clicks: 7628, conversions: 0 },
                            { name: "Misting-Maintenance Search", status: "paused", spend: 2304.24, impressions: 4964, clicks: 253, conversions: 4 },
                            { name: "Misting Refill", status: "paused", spend: 2257.37, impressions: 63441, clicks: 814, conversions: 25 },
                            { name: "LeadGen-Search", status: "enabled", spend: 1751.03, impressions: 1897, clicks: 187, conversions: 28 },
                            { name: "Search Swat Mosquito", status: "paused", spend: 1416.15, impressions: 5928, clicks: 154, conversions: 7 },
                            { name: "Lead Gen-Performance Max", status: "enabled", spend: 1265.49, impressions: 184107, clicks: 1725, conversions: 8 },
                            { name: "Mosquito Control Service (old)", status: "paused", spend: 1018.78, impressions: 96763, clicks: 852, conversions: 13 },
                            { name: "Google Build", status: "paused", spend: 955.92, impressions: 11628, clicks: 186, conversions: 5 },
                            { name: "Vince Youtube", status: "enabled", spend: 819.44, impressions: 56012, clicks: 3281, conversions: 0 },
                            { name: "Local Ad - Map Ad", status: "removed", spend: 731.61, impressions: 296700, clicks: 1506, conversions: 7 },
                            { name: "MoJo Vid Lead - Grandma 15s", status: "removed", spend: 574.01, impressions: 65624, clicks: 320, conversions: 0 },
                            { name: "PMax: Local Ad", status: "enabled", spend: 437.69, impressions: 506277, clicks: 709, conversions: 3 },
                            { name: "Misting System 15sec Ad", status: "removed", spend: 444.03, impressions: 26186, clicks: 124, conversions: 0 },
                            { name: "Lead Form Mar15-24", status: "paused", spend: 395.51, impressions: 3711, clicks: 242, conversions: 15 },
                            { name: "Cyber Monday Display", status: "paused", spend: 366.58, impressions: 166592, clicks: 1233, conversions: 0 },
                            { name: "Discovery Barrier Treatments", status: "paused", spend: 249.32, impressions: 22719, clicks: 313, conversions: 0 },
                            { name: "Misting System Search", status: "paused", spend: 220.30, impressions: 730, clicks: 34, conversions: 1 },
                            { name: "YouTube Video Views", status: "enabled", spend: 150.05, impressions: 32206, clicks: 167, conversions: 0 },
                            { name: "Best Mosquito Control Miami", status: "paused", spend: 144.98, impressions: 7222, clicks: 23, conversions: 0 },
                            { name: "Re-targeting $39.99 Special", status: "paused", spend: 137.78, impressions: 68356, clicks: 103, conversions: 0 },
                            { name: "Leads Display Apr19", status: "paused", spend: 93.72, impressions: 8048, clicks: 154, conversions: 0 },
                            { name: "Misting Retarget Video", status: "removed", spend: 80.33, impressions: 4325, clicks: 13, conversions: 0 }
                        ],
                        totalSpend: 99060.51
                    }
                }
            }
        };

        let spendChart, clicksChart;

        function formatCurrency(val) {
            return '$' + parseFloat(val).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        function formatNumber(val) {
            return parseInt(val).toLocaleString('en-US');
        }

        function updateDashboard() {
            const range = document.getElementById('dateRange').value;
            const data = dashboardData.ranges[range];
            
            if (!data) return;
            
            document.getElementById('lastUpdated').textContent = dashboardData.lastUpdated;
            
            // Calculate totals
            const metaSpend = data.meta.campaigns.reduce((sum, c) => sum + parseFloat(c.spend || 0), 0);
            const metaClicks = data.meta.campaigns.reduce((sum, c) => sum + parseInt(c.clicks || 0), 0);
            const metaImpressions = data.meta.campaigns.reduce((sum, c) => sum + parseInt(c.impressions || 0), 0);
            
            const googleSpend = data.google.campaigns.reduce((sum, c) => sum + parseFloat(c.spend || 0), 0);
            const googleClicks = data.google.campaigns.reduce((sum, c) => sum + parseInt(c.clicks || 0), 0);
            const googleImpressions = data.google.campaigns.reduce((sum, c) => sum + parseInt(c.impressions || 0), 0);
            const googleConversions = data.google.campaigns.reduce((sum, c) => sum + parseInt(c.conversions || 0), 0);
            
            const totalSpend = metaSpend + googleSpend;
            const totalClicks = metaClicks + googleClicks;
            const totalImpressions = metaImpressions + googleImpressions;
            
            // Update metrics
            document.getElementById('totalSpend').textContent = formatCurrency(totalSpend);
            document.getElementById('totalClicks').textContent = formatNumber(totalClicks);
            document.getElementById('avgCPC').textContent = formatCurrency(totalClicks > 0 ? totalSpend / totalClicks : 0);
            document.getElementById('totalImpressions').textContent = formatNumber(totalImpressions);
            document.getElementById('totalConversions').textContent = formatNumber(googleConversions);
            document.getElementById('costPerConv').textContent = formatCurrency(googleConversions > 0 ? totalSpend / googleConversions : 0);
            
            document.getElementById('metaTotal').textContent = formatCurrency(metaSpend);
            document.getElementById('googleTotal').textContent = formatCurrency(googleSpend);
            
            // Render Meta table
            const metaBody = document.getElementById('metaBody');
            if (data.meta.campaigns.length === 0) {
                metaBody.innerHTML = '<tr><td colspan="7" class="no-data">No data for this period</td></tr>';
            } else {
                metaBody.innerHTML = data.meta.campaigns.map(c => `
                    <tr>
                        <td>${c.name}</td>
                        <td><span class="status ${c.status.toLowerCase()}">${c.status}</span></td>
                        <td>${formatCurrency(c.spend)}</td>
                        <td>${formatNumber(c.impressions)}</td>
                        <td>${formatNumber(c.clicks)}</td>
                        <td>${formatCurrency(c.cpc)}</td>
                        <td>${c.ctr}</td>
                    </tr>
                `).join('');
            }
            
            // Render Google table
            const googleBody = document.getElementById('googleBody');
            if (data.google.campaigns.length === 0) {
                googleBody.innerHTML = '<tr><td colspan="6" class="no-data">No data for this period</td></tr>';
            } else {
                googleBody.innerHTML = data.google.campaigns.map(c => `
                    <tr>
                        <td>${c.name}</td>
                        <td><span class="status ${c.status}">${c.status}</span></td>
                        <td>${formatCurrency(c.spend)}</td>
                        <td>${formatNumber(c.impressions)}</td>
                        <td>${formatNumber(c.clicks)}</td>
                        <td>${formatNumber(c.conversions)}</td>
                    </tr>
                `).join('');
            }
            
            // Update charts
            if (spendChart) spendChart.destroy();
            if (clicksChart) clicksChart.destroy();
            
            spendChart = new Chart(document.getElementById('spendChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Meta Ads', 'Google Ads'],
                    datasets: [{
                        data: [metaSpend, googleSpend],
                        backgroundColor: ['#1877f2', '#34a853'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
            
            clicksChart = new Chart(document.getElementById('clicksChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Meta Ads', 'Google Ads'],
                    datasets: [{
                        data: [metaClicks, googleClicks],
                        backgroundColor: ['#1877f2', '#34a853'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }
        
        // Initial render
        updateDashboard();
    </script>
</body>
</html>
